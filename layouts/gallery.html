{{ define "title" }}{{ .Title }} | {{ .Site.Title }}{{ end }}

{{ define "main" }}
<div class="container">
  <header class="page-header">
    <h1>{{ .Title }}</h1>
    <p class="lead">{{ .Param "description" | default .Summary }}</p>
    <label for="gen-filter" class="gen-filter-label">Gera√ß√£o</label>
    <select id="gen-filter" class="gen-filter" aria-label="Filtrar por gera√ß√£o">
      <option value="1" selected>Gera√ß√£o 1 (Kanto)</option>
      <option value="2">Gera√ß√£o 2 (Johto)</option>
      <option value="3">Gera√ß√£o 3 (Hoenn)</option>
      <option value="4">Gera√ß√£o 4 (Sinnoh)</option>
      <option value="5">Gera√ß√£o 5 (Unova)</option>
      <option value="6">Gera√ß√£o 6 (Kalos)</option>
      <option value="7">Gera√ß√£o 7 (Alola)</option>
      <option value="8">Gera√ß√£o 8 (Galar)</option>
      <option value="9">Gera√ß√£o 9 (Paldea)</option>
    </select>
  </header>

  <div class="pokemon-grid">
    {{ $whatsapp := .Site.Params.whatsapp_number }}
    {{ range site.Data.pokemon }}
      {{ $id := int .id }}
      {{ $gen := cond (ge $id 906) 9 (cond (ge $id 810) 8 (cond (ge $id 722) 7 (cond (ge $id 650) 6 (cond (ge $id 494) 5 (cond (ge $id 387) 4 (cond (ge $id 252) 3 (cond (ge $id 152) 2 1))))))) }}
      {{ $imgPath := printf "pokemon/%03d/1.jpg" $id }}
      {{ $hasImage := eq .image true }}

      <article class="pokemon-card {{ if not $hasImage }}pokemon-card--placeholder{{ end }}" data-generation="{{ $gen }}">
        <div class="pokemon-card__media">
          {{ if $hasImage }}
            <img src="{{ .Site.BaseURL }}{{ $imgPath }}" alt="{{ .name }}" class="pokemon-card__img" loading="lazy">
            <span class="badge badge--done">J√° feito</span>
          {{ else }}
            <div class="pokemon-card__placeholder" aria-hidden="true">
              <span class="pokemon-card__silhouette" aria-hidden="true"></span>
              <span class="pokemon-card__name-placeholder">{{ .name }}</span>
            </div>
            <span class="badge badge--soon">Em breve</span>
          {{ end }}
        </div>
        <div class="pokemon-card__body">
          <h2 class="pokemon-card__title">{{ .name }}</h2>
          <p class="pokemon-card__id">#{{ printf "%03d" $id }}</p>
          <a href="https://wa.me/{{ $whatsapp }}?text=Ol√°! Vi o Pok√©mon {{ .name }} no teu site üôÇ" class="btn btn-whatsapp" target="_blank" rel="noopener">Contactar no WhatsApp</a>
        </div>
      </article>
    {{ end }}
  </div>

  {{ .Content }}
</div>

<script>
(function() {
  var select = document.getElementById('gen-filter');
  var grid = document.querySelector('.pokemon-grid');
  if (!select || !grid) return;
  var cards = grid.querySelectorAll('.pokemon-card');
  function filter() {
    var val = select.value;
    cards.forEach(function(card) {
      card.style.display = card.getAttribute('data-generation') === val ? '' : 'none';
    });
  }
  filter();
  select.addEventListener('change', filter);
})();
</script>
{{ end }}


